import{h as Q,i as h,m as _,j as T,o as R,q as G,a as o,c as l,b as e,n as L,t as d,f as w,y as H,F as D,r as V,_ as K,z as W,k as X,l as Y,v as Z,d as g,e as ee,g as te}from"./app-BXe2DA_a.js";const I=Q("memory",()=>{const c=h([]),s=h(null),i=h(!1),p=h(null),f=h(""),u=h("all"),y=h({currentPage:1,perPage:20,total:0,lastPage:1}),B={experience:{label:"Experience",color:"blue",icon:"star"},conversation:{label:"Conversation",color:"green",icon:"chat"},learned:{label:"Learned",color:"purple",icon:"book"},social:{label:"Social",color:"yellow",icon:"users"},reflection:{label:"Reflection",color:"indigo",icon:"lightbulb"}},C=_(()=>{let r=c.value;if(u.value!=="all"&&(r=r.filter(m=>m.type===u.value)),f.value.trim()){const m=f.value.toLowerCase();r=r.filter(k=>{var x,E,j;return((x=k.content)==null?void 0:x.toLowerCase().includes(m))||((E=k.summary)==null?void 0:E.toLowerCase().includes(m))||((j=k.related_entity)==null?void 0:j.toLowerCase().includes(m))})}return r}),$=_(()=>y.value.currentPage<y.value.lastPage),F=_(()=>y.value.total),P=_(()=>c.value.filter(r=>r.importance>=.7).slice(0,10)),S=_(()=>[...c.value].sort((r,m)=>new Date(m.created_at)-new Date(r.created_at)).slice(0,10));async function n(r={}){var j,N;const{page:m=1,type:k=null,search:x=null,append:E=!1}=r;i.value=!0,p.value=null;try{const b=new URLSearchParams;b.append("page",m),b.append("per_page",y.value.perPage),k&&k!=="all"&&b.append("type",k),x&&b.append("search",x);const M=await T.get(`/api/v1/memory?${b.toString()}`);return E?c.value=[...c.value,...M.data.data]:c.value=M.data.data||M.data,M.data.meta&&(y.value={currentPage:M.data.meta.current_page,perPage:M.data.meta.per_page,total:M.data.meta.total,lastPage:M.data.meta.last_page}),c.value}catch(b){throw console.error("Failed to fetch memories:",b),p.value=((N=(j=b.response)==null?void 0:j.data)==null?void 0:N.message)||"Failed to load memories",b}finally{i.value=!1}}async function a(r){return f.value=r,r.trim()?n({search:r,type:u.value!=="all"?u.value:null}):n({type:u.value})}async function t(r){var m,k;i.value=!0,p.value=null;try{const x=await T.get(`/api/v1/memory/${r}`);return s.value=x.data.data||x.data,s.value}catch(x){throw console.error("Failed to fetch memory:",x),p.value=((k=(m=x.response)==null?void 0:m.data)==null?void 0:k.message)||"Failed to load memory",x}finally{i.value=!1}}async function v(){if(!(!$.value||i.value))return n({page:y.value.currentPage+1,type:u.value!=="all"?u.value:null,search:f.value||null,append:!0})}function z(r){u.value=r,y.value.currentPage=1,n({type:r!=="all"?r:null,search:f.value||null})}function U(r){s.value=r}function A(){s.value=null}function O(){f.value="",n({type:u.value!=="all"?u.value:null})}async function q(r){try{const m=await T.get(`/api/v1/memory/${r}/related`);return m.data.data||m.data}catch(m){return console.error("Failed to fetch related memories:",m),[]}}async function J(){try{return(await T.get("/api/v1/memory/statistics")).data}catch(r){return console.error("Failed to fetch memory statistics:",r),null}}return{memories:c,selectedMemory:s,isLoading:i,error:p,searchQuery:f,activeFilter:u,pagination:y,memoryTypes:B,filteredMemories:C,hasMorePages:$,totalMemories:F,importantMemories:P,recentMemories:S,fetchMemories:n,searchMemories:a,fetchMemoryById:t,loadMore:v,setFilter:z,selectMemory:U,clearSelection:A,clearSearch:O,fetchRelatedMemories:q,fetchStatistics:J}}),ae={class:"modal-content"},se={class:"modal-header"},re={class:"flex items-center gap-3"},oe={class:"text-sm text-gray-500 dark:text-gray-400"},le={class:"modal-body space-y-6"},ne={key:0},ie={class:"text-gray-700 dark:text-gray-300"},ce={class:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4"},de={class:"text-gray-700 dark:text-gray-300 whitespace-pre-wrap"},ue={class:"grid grid-cols-2 gap-4"},me={class:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4"},ye={class:"flex items-center gap-3"},ge={class:"flex-1 progress-bar"},ve={class:"text-sm font-medium text-gray-900 dark:text-gray-100"},pe={class:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4"},xe={key:0,class:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4"},fe={class:"text-gray-900 dark:text-gray-100"},he={key:1,class:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4"},ke={class:"text-gray-900 dark:text-gray-100"},be={key:1},_e={key:0,class:"space-y-3"},we={key:1,class:"space-y-3"},Me={class:"flex-1 min-w-0"},Ce={class:"text-sm text-gray-700 dark:text-gray-300 truncate"},$e={class:"modal-footer"},Se={__name:"MemoryDetailModal",props:{memory:{type:Object,required:!0}},emits:["close"],setup(c,{emit:s}){const i=c,p=s,f=I(),u=h([]),y=h(!1),B=_(()=>({experience:"memory-type-experience",conversation:"memory-type-conversation",learned:"memory-type-learned",social:"memory-type-social",reflection:"memory-type-reflection"})[i.memory.type]||"memory-type-experience"),C=_(()=>Math.round((i.memory.importance||0)*100)),$=_(()=>{const a=i.memory.emotional_valence||0;return a>.3?{label:"Positive",class:"text-green-600 dark:text-green-400"}:a<-.3?{label:"Negative",class:"text-red-600 dark:text-red-400"}:{label:"Neutral",class:"text-gray-600 dark:text-gray-400"}}),F=_(()=>i.memory.created_at?new Date(i.memory.created_at).toLocaleString("de-DE",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Unknown");async function P(){if(i.memory.id){y.value=!0;try{u.value=await f.fetchRelatedMemories(i.memory.id)}catch(a){console.error("Failed to load related memories:",a)}finally{y.value=!1}}}function S(a){a.target===a.currentTarget&&p("close")}function n(a){a.key==="Escape"&&p("close")}return R(()=>{document.addEventListener("keydown",n),P()}),G(()=>{document.removeEventListener("keydown",n)}),(a,t)=>(o(),l("div",{class:"modal-overlay",onClick:S},[e("div",ae,[e("div",se,[e("div",re,[e("span",{class:L(["memory-type-badge",B.value])},d(c.memory.type),3),e("span",oe,d(F.value),1)]),e("button",{onClick:t[0]||(t[0]=v=>a.$emit("close")),class:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors"},[...t[2]||(t[2]=[e("svg",{class:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("div",le,[c.memory.summary?(o(),l("div",ne,[t[3]||(t[3]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-2"}," Summary ",-1)),e("p",ie,d(c.memory.summary),1)])):w("",!0),e("div",null,[t[4]||(t[4]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-2"}," Content ",-1)),e("div",ce,[e("p",de,d(c.memory.content),1)])]),e("div",ue,[e("div",me,[t[5]||(t[5]=e("h4",{class:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-2"}," Importance ",-1)),e("div",ye,[e("div",ge,[e("div",{class:"progress-bar-fill",style:H({width:C.value+"%"})},null,4)]),e("span",ve,d(C.value)+"% ",1)])]),e("div",pe,[t[6]||(t[6]=e("h4",{class:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-2"}," Emotional Valence ",-1)),e("span",{class:L(["text-lg font-medium",$.value.class])},d($.value.label),3)]),c.memory.related_entity?(o(),l("div",xe,[t[7]||(t[7]=e("h4",{class:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-2"}," Related Entity ",-1)),e("span",fe,d(c.memory.related_entity),1)])):w("",!0),c.memory.context?(o(),l("div",he,[t[8]||(t[8]=e("h4",{class:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-2"}," Context ",-1)),e("span",ke,d(typeof c.memory.context=="object"?JSON.stringify(c.memory.context):c.memory.context),1)])):w("",!0)]),u.value.length>0||y.value?(o(),l("div",be,[t[9]||(t[9]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-3"}," Related Memories ",-1)),y.value?(o(),l("div",_e,[(o(),l(D,null,V(3,v=>e("div",{key:v,class:"skeleton-card h-20"})),64))])):(o(),l("div",we,[(o(!0),l(D,null,V(u.value,v=>(o(),l("div",{key:v.id,class:"bg-gray-50 dark:bg-gray-800 rounded-lg p-3 flex items-start gap-3"},[e("span",{class:L(["memory-type-badge",`memory-type-${v.type}`])},d(v.type),3),e("div",Me,[e("p",Ce,d(v.summary||v.content),1)])]))),128))]))])):w("",!0)]),e("div",$e,[e("button",{onClick:t[1]||(t[1]=v=>a.$emit("close")),class:"btn btn-secondary"}," Close ")])])]))}},Le={class:"p-8 bg-gray-50 dark:bg-gray-950 min-h-full transition-colors duration-200"},Pe={class:"max-w-5xl mx-auto"},Be={class:"card mb-6"},Fe={class:"card-body"},je={class:"flex flex-col lg:flex-row gap-4"},De={class:"flex-1 relative"},Ve={class:"flex items-center gap-4 text-sm"},Ee={class:"flex items-center gap-2 px-4 py-2 bg-gray-100 dark:bg-gray-800 rounded-lg"},Te={class:"font-semibold text-gray-900 dark:text-gray-100"},ze={class:"flex items-center gap-2 px-4 py-2 bg-gray-100 dark:bg-gray-800 rounded-lg"},Ne={class:"font-semibold text-gray-900 dark:text-gray-100"},Re={class:"tab-list mb-6"},He=["onClick"],Ie={key:0,class:"grid gap-4 md:grid-cols-2"},Ue={key:1,class:"empty-state"},Ae={class:"empty-state-description"},Oe={key:2,class:"grid gap-4 md:grid-cols-2"},qe=["onClick"],Je={class:"flex items-start justify-between mb-3"},Qe={class:"text-xs text-gray-500 dark:text-gray-400"},Ge={class:"text-gray-700 dark:text-gray-300 mb-3 line-clamp-3"},Ke={class:"flex items-center justify-between text-sm pt-3 border-t border-gray-200 dark:border-gray-700"},We={key:0,class:"flex items-center gap-2"},Xe={class:"text-gray-600 dark:text-gray-400"},Ye={key:1},Ze={class:"flex items-center gap-3"},et={class:"flex items-center gap-1.5"},tt={class:"w-16 h-1.5 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden"},at={class:"text-xs text-gray-500 dark:text-gray-400"},st={key:3,class:"mt-6 text-center"},rt=["disabled"],ot={key:0,class:"flex items-center gap-2"},lt={key:1},nt={__name:"Memory",setup(c){const s=I(),i=h(""),p=h(!1),f=[{value:"all",label:"All Memories",icon:"collection"},{value:"experience",label:"Experiences",icon:"star"},{value:"conversation",label:"Conversations",icon:"chat"},{value:"learned",label:"Learned",icon:"book"},{value:"social",label:"Social",icon:"users"}];function u(n){return{experience:"memory-type-experience",conversation:"memory-type-conversation",learned:"memory-type-learned",social:"memory-type-social",reflection:"memory-type-reflection"}[n]||"memory-type-experience"}function y(n){return n>.3?{text:"Positive",class:"text-green-600 dark:text-green-400",icon:"+"}:n<-.3?{text:"Negative",class:"text-red-600 dark:text-red-400",icon:"-"}:{text:"Neutral",class:"text-gray-600 dark:text-gray-400",icon:"~"}}function B(n){return n?new Date(n).toLocaleDateString("de-DE",{year:"numeric",month:"short",day:"numeric"}):""}function C(n){s.setFilter(n)}function $(n){s.selectMemory(n),p.value=!0}function F(){p.value=!1,s.clearSelection()}function P(){i.value="",s.clearSearch()}let S=null;return W(i,n=>{S&&clearTimeout(S),S=setTimeout(()=>{s.searchMemories(n)},300)}),R(()=>{s.fetchMemories()}),(n,a)=>(o(),l("div",Le,[e("div",Pe,[a[12]||(a[12]=X('<div class="mb-8" data-v-7f30ebcd><h1 class="text-2xl font-bold mb-2 flex items-center gap-3 text-gray-900 dark:text-gray-100" data-v-7f30ebcd><svg class="w-8 h-8 text-entity-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-7f30ebcd><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" data-v-7f30ebcd></path></svg> Memory Browser </h1><p class="text-gray-500 dark:text-gray-400" data-v-7f30ebcd> Browse through stored experiences, conversations, and learned knowledge. </p></div>',1)),e("div",Be,[e("div",Fe,[e("div",je,[e("div",De,[a[4]||(a[4]=e("svg",{class:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1)),Y(e("input",{"onUpdate:modelValue":a[0]||(a[0]=t=>i.value=t),type:"text",class:"input pl-10 pr-10",placeholder:"Search memories by content, summary, or entity..."},null,512),[[Z,i.value]]),i.value?(o(),l("button",{key:0,onClick:P,class:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},[...a[3]||(a[3]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])):w("",!0)]),e("div",Ve,[e("div",Ee,[a[5]||(a[5]=e("span",{class:"text-gray-500 dark:text-gray-400"},"Total:",-1)),e("span",Te,d(g(s).totalMemories),1)]),e("div",ze,[a[6]||(a[6]=e("span",{class:"text-gray-500 dark:text-gray-400"},"Showing:",-1)),e("span",Ne,d(g(s).filteredMemories.length),1)])])])])]),e("div",Re,[(o(),l(D,null,V(f,t=>e("button",{key:t.value,onClick:v=>C(t.value),class:L(["tab-button",{active:g(s).activeFilter===t.value}])},d(t.label),11,He)),64))]),e("div",null,[g(s).isLoading&&g(s).memories.length===0?(o(),l("div",Ie,[(o(),l(D,null,V(6,t=>e("div",{key:t,class:"skeleton-card"})),64))])):g(s).filteredMemories.length===0?(o(),l("div",Ue,[a[7]||(a[7]=e("div",{class:"w-20 h-20 mx-auto mb-4 rounded-full bg-gray-200 dark:bg-gray-800 flex items-center justify-center"},[e("svg",{class:"w-10 h-10 text-gray-400 dark:text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})])],-1)),a[8]||(a[8]=e("h3",{class:"empty-state-title"},"No memories found",-1)),e("p",Ae,d(i.value?"Try a different search term.":"Memories will appear here as they are created."),1),i.value||g(s).activeFilter!=="all"?(o(),l("button",{key:0,onClick:a[1]||(a[1]=t=>{P(),C("all")}),class:"mt-4 btn btn-secondary"}," Clear Filters ")):w("",!0)])):(o(),l("div",Oe,[(o(!0),l(D,null,V(g(s).filteredMemories,t=>{var v;return o(),l("div",{key:t.id,onClick:z=>$(t),class:L(["memory-card group",{selected:((v=g(s).selectedMemory)==null?void 0:v.id)===t.id}])},[e("div",Je,[e("span",{class:L(["memory-type-badge",u(t.type)])},d(t.type),3),e("span",Qe,d(B(t.created_at)),1)]),e("p",Ge,d(t.summary||t.content),1),e("div",Ke,[t.related_entity?(o(),l("div",We,[a[9]||(a[9]=e("svg",{class:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})],-1)),e("span",Xe,d(t.related_entity),1)])):(o(),l("div",Ye)),e("div",Ze,[e("div",et,[e("div",tt,[e("div",{class:"h-full bg-entity-500 rounded-full",style:H({width:t.importance*100+"%"})},null,4)]),e("span",at,d(Math.round(t.importance*100))+"% ",1)]),t.emotional_valence!==void 0?(o(),l("span",{key:0,class:L(["text-xs font-medium",y(t.emotional_valence).class])},d(y(t.emotional_valence).icon)+d(Math.abs(Math.round(t.emotional_valence*100)))+"% ",3)):w("",!0)])]),a[10]||(a[10]=e("div",{class:"absolute top-3 right-3 opacity-0 group-hover:opacity-100 transition-opacity"},[e("svg",{class:"w-5 h-5 text-entity-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})])],-1))],10,qe)}),128))])),g(s).hasMorePages?(o(),l("div",st,[e("button",{onClick:a[2]||(a[2]=(...t)=>g(s).loadMore&&g(s).loadMore(...t)),disabled:g(s).isLoading,class:"btn btn-secondary"},[g(s).isLoading?(o(),l("span",ot,[...a[11]||(a[11]=[e("svg",{class:"animate-spin w-4 h-4",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),ee(" Loading... ",-1)])])):(o(),l("span",lt,"Load More"))],8,rt)])):w("",!0)])]),p.value&&g(s).selectedMemory?(o(),te(Se,{key:0,memory:g(s).selectedMemory,onClose:F},null,8,["memory"])):w("",!0)]))}},ct=K(nt,[["__scopeId","data-v-7f30ebcd"]]);export{ct as default};
